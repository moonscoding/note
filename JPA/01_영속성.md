# 영속성관리

## 차례

- 엔티티 매니저 팩토리와 엔티티 매니저
- 영속성 컨텍스트란 
- 엔티티의 생명주기
- 영속성 컨텍스트의 특징
- 플래시
- 준영속
- 정리



## 엔티티 매니저 팩토리와 엔티티 매니저



## 영속성 컨텍스트

엔티티를 영구 저장하는 환경

엔티티 매니저로 엔티티를 저장하거나 조회하면 엔티티 매니저는 영속성 컨텍스트에 엔티티를 보관하고 관리



## 엔티티 생명주기

- 비영속 (new/transient)
  - 영속성 컨텍스트와 전혀 관계가 없는 상태
- 영속 (managed)
  - 영속성 컨텍스트에 저장된 상태
- 준영속 (detached)
  - 영속성 컨텍스트에 저장되었다가 분리된 상태
- 삭제 (removed)
  - 삭제된 상태



## 영속성 컨텍스트 특징

- 영속성 컨텍스트와 식별자 값
  - 영속성 컨텍스트는 엔티티를 식별자 값(@Id로 테이블의 기본 키와 매핑한 값)으로 구분
  - 따라서 영속 상태는 식별자 값이 반드시 있어야
  - 식별자 값이 없으면 예외
- 영속성 컨텍스트와 데이터 베이스 저장
  - 영속성 컨텍스트에 엔티티를 저장하면 이 엔티티는 언제 데이터베이스에 저장될까
  - JPA는 보통 트랜잭션 커밋을 하는 순간 영속성 컨텍스트로 새로 저장된 엔티티를 데이터베이스에 반영
  - 이것을 플러시(flush)라고 합니다
- 영속성 컨텍스트가 엔티티를 관리할때 장점
  - 1차 캐시
  - 동일성 보장 
  - 트랜잭션을 지원하는 쓰기 지연
  - 변경 감지
  - 지연 로딩



### 엔티티 조회 

